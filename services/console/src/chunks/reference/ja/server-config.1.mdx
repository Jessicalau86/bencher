Bencher APIサーバーは起動時にJSON設定を必要とします。
設定は3つの方法で提供できます：
- `BENCHER_CONFIG` 環境変数：値はJSON設定に設定する必要があります
- `BENCHER_CONFIG_PATH` 環境変数：値はJSON設定を含むファイルのパスに設定する必要があります
- JSON設定を含むファイルをサーバー実行可能ファイルに対して相対的に `./bencher.json` で配置します

設定が見つからない場合、デフォルトの設定がロードされます。

サーバーが稼働している間に設定を更新するには、
管理者はCLI `bencher server config update` コマンドを使用できます
これは[PUT `/v0/server/config`](/docs/reference/api) ルートを利用します。
すべての更新された設定は `BENCHER_CONFIG` 環境変数に保存され、
`BENCHER_CONFIG_PATH` のディスク上にも保存されます。

JSON設定の例：

```
{
  "console": {
    "url": "https://bencher.example.com"
  },
  "security": {
    "issuer": "https://api.bencher.example.com",
    "secret_key": "UJu7Cpxb-zFaJYqXD-3mDDSDyj-ZvfxZFZs-X58xjxPy"
  },
  "server": {
    "bind_address": "0.0.0.0:61016",
    "request_body_max_bytes": 1048576,
    "tls": {
      "type": "as_file",
      "cert_file": "/path/to/cert.pem",
      "key_file": "/path/to/key.pem"
    }
  },
  "logging": {
    "name": "Bencher API",
    "log": {
      "stderr_terminal": {
        "level": "info"
      }
    },
  },
  "database": {
    "file": "data/bencher.db",
    "data_store": {
      "service": "aws_s3"
      "access_key_id": "ABC123DoRemMiABC123",
      "secret_access_key": "AA3Chr-JSF5sUQqKwayx-FvCfZKsMev-5BqPpcFC3m7",
      "access_point": "arn:aws:s3:some-region-1:123456789:accesspoint/my-bucket/path/to/backup/dir"
    }
  },
  "smtp": {
    "hostname": "mailbonobo.com",
    "port": 587,
    "starttls": true,
    "username": "bencher"
    "secret": "WM3F2u9cqSNdBPLfy9sJ5kk9",
    "from_name": "Bencher",
    "from_email": "info@bencher.example.com"
  },
  "apm": {
    "sentry": {
      "dsn": "https://0123abc1023abc@987efg987efg.ingest.sentry.io/0123456789"
    }
  }
}
```

## `console`

| 名前  |              例               |       デフォルト        | 必須  |                     説明                      |
| :---: | :---------------------------: | :---------------------: | :---: | :-------------------------------------------: |
|  url  | "https://bencher.example.com" | "http://localhost:3000" | はい  | Bencher UIコンソールホストのURLを指定します。 |

## `security`

|    名前    |                       例                       |   デフォルト   |  必須  |                                                                                                                                    説明                                                                                                                                     |
| :--------: | :--------------------------------------------: | :------------: | :----: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|   issuer   |       "https://api.bencher.example.com"        | "bencher.dev"  | いいえ |                                                                      JSON Webトークン（JWT）の発行者を指定します。 **警告** この値を変更すると、すでに生成されたすべてのJWTの検証ができなくなります。                                                                       |
| secret_key | "UJu7Cpxb-zFaJYqXD-3mDDSDyj-ZvfxZFZs-X58xjxPy" | Random UUID v4 |  はい  | すべてのトークンを生成するために使用されるキーを指定します。 **非常に安全であるべきです！** デフォルト値はランダムに生成された [UUID v4](https://ja.wikipedia.org/wiki/UUID#UUID_v4_-_ランダム生成)です。ログに記録されるとき、それは絶対に `************` と表示されます。 |

# `server`

このセクションは [Dropshotサーバー設定](https://github.com/oxidecomputer/dropshot/tree/v0.9.0#dropshot-servers) に基づいています。

|          名前          |        例例         |   デフォルト    |          必須          |                                                                                                                       説明                                                                                                                       |
| :--------------------: | :-----------------: | :-------------: | :--------------------: | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|      bind_address      |   "0.0.0.0:61016"   | "0.0.0.0:61016" |          はい          | サーバーが指定されたIPアドレスとTCPポートにバインドする必要があることを指定します。一般的に、サーバーは複数のIPアドレスとポートにバインドすることができますが、これはまだサポートされていません。デフォルトは "127.0.0.1:0" に設定されています。 |
| request_body_max_bytes |       1048576       |     1048576     |          はい          |                                                               要求の本文で許容されるバイト数の最大値を指定します。大きな要求は400のエラーを受け取ります。デフォルトは 1024 です。                                                                |
|        tls.type        |      "as_file"      |       ---       |         いいえ         |                                                                    TLS証明書とキー情報が提供される場合と方法を指定します。有効な値には "as_file" と "as_bytes" が含まれます。                                                                    |
|     tls.cert_file      | "/path/to/cert.pem" |       ---       | if tls.type = as_file  |        サーバーが自身を識別するための証明書チェーンを含むPEMファイルへのパスを指定します。最初の証明書はエンドエンティティ証明書であり、残りは信頼できるCAへの途中の中間証明書です。指定された場合、サーバーはTLS接続のみを受け付けます。        |
|      tls.key_file      | "/path/to/key.pem"  |       ---       | if tls.type = as_file  |                                                        サーバーが使用するプライベートキーを含むPKCS＃8ファイルへのパスを指定します。指定した場合、サーバーはTLS接続のみをリッスンします。                                                        |
|       tls.certs        |         ---         |       ---       | if tls.type = as_bytes |                                                                                     tls.cert_fileと同じですが、証明書データのバイト配列として提供されます。                                                                                      |
|        tls.key         |         ---         |       ---       | if tls.type = as_bytes |                                                                                       tls.key_fileと同じですが、キーデータのバイト配列として提供されます。                                                                                       |